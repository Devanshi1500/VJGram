
<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">

<div class="card mb-3">
	<div class="card-header">
		<div class="row">
	<div class="card-body">
		<h2><a class="article-title">{{ object.title }}</a></h2>
		<p class="article-content">{{ object.description }}</p>

		{% if group.creator == user %}
		  <div>
		  <a class="btn btn secondary btn-sm mt-1" href="{%url 'group-update' group.group_id %}" >Update</a>
		  <a class="btn btn danger btn-sm mt-1" href="{%url 'group-delete' group.group_id %}"> Delete</a>
		  </div>
		{% endif %}
	</div>
</div>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
<style>
  body {
    font-size: 1em;
	font-family: 'Gill Sans', 'Gill Sans MT', Calibri, 'Trebuchet MS', sans-serif;
	
  }

  .chat .messages {
    border:1 px solid;
    background-color:#ffffff;
	border-radius: 15px;
    width:40%;
    padding:10px;
	margin: auto;
    overflow-y:scroll;
	height:350px;
	color: snow;
  }

  form{
	  margin: auto;
	  width: 50%;
  }


  .chat .message a {
    color:slategray;
  }

  .chat .message p{
    margin:5px;
  }

  .speech-bubble {
	position: relative;
	background: #016464;
	border-radius: .4em;
}

.speech-bubble:after {
	content: '';
	position: absolute;
	left: 0;
	top: 50%;
	width: 0;
	height: 0;
	border: 18px solid transparent;
	border-right-color: #016464;
	border-left: 0;
	border-top: 0;
	margin-top: -9px;
	margin-left: -18px;
}
</style>
<div class="chat container">
	<div class="messages">
		<ul style="list-style-type: none;">
		{% for chat in chats %}
			<li class="speech-bubble" style="border: 1px solid #016464; background-color: #016464; border-radius: 10px; padding: 1rem;">
				<span style="float: left;"><b>{{chat.user_id_from}}: </b></span>
				<span>{{chat.content}}</span><br>
				<span style="font-size: 10px; float: right;">{{chat.date_created}}</span>
			</li><br>
		{% endfor %}
	</ul>
	</div>
<br>
		<form method="POST" style="text-align: center;">
			{% csrf_token %}

		<input class="form-group" type="text" id="fname" data-commentid="{{ group.group_id }}" style="width: 50%; padding: 5px; border-radius: 10px;">
		<button type="button" class="postbutton btn btn-outline-success" id="comment" data-commentid="{{ group.group_id }}" >
			post
		</button>
		</form>
		<div>
		{% for member in mt %}
				{{member}}
		{% endfor %}
		</div>
</div>
<script src="https://ajax.aspnetcdn.com/ajax/jQuery/jquery-3.4.1.min.js"></script>
<script type="text/javascript">

$(function()
{
$('.postbutton').click
(
	function()
	{
			var catid;
			catid = $(this).attr("data-commentid");
		$(this).css("background-color","blue");
		var cid;
		cid = $(this).attr("data-commentid");
		var comment_data;
		comment_data = $(this).parent().find("#fname").val();
		console.log(comment_data)

			$.ajax
		(
				{
						type:"POST",
						url: "/chat/push",
						data:{
						group_id:cid,
						content: comment_data,
							},
							success:function(data){
								var prevState = $(".chat .messages").html();
								console.log(prevState.length);
								message = data.user_id+" "+data.content;
								if(prevState.length >4)
								{ prevState = prevState+"<br>";}
								$(".chat .messages").html(prevState + message );
							}

				}
		)
		console.log("this comment executed correctly");
	}
)
});
</script>
